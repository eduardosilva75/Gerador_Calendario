name: Build Windows Executable

on:
  push:
    tags: ['v*']  # Executa quando criar uma tag (ex: v1.0.0)
  release:
    types: [published]  # Executa quando criar um release
  workflow_dispatch:  # Permite execuÃ§Ã£o manual

jobs:
  build-windows:
    name: Build Windows Executable
    runs-on: windows-latest
    
    steps:
    - name: Checkout cÃ³digo
      uses: actions/checkout@v4
      
    - name: Configurar Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'
        architecture: 'x64'
        
    - name: Instalar dependÃªncias
      run: |
        python -m pip install --upgrade pip
        pip install openpyxl altgraph pyinstaller
        
    - name: Verificar instalaÃ§Ãµes
      run: |
        python --version
        pip list
        
    - name: Criar executÃ¡vel SEM consola
      run: |
        pyinstaller --onefile --noconsole --name "Gerador_Calendario_Folgas" calendarioGeral.py
        dir dist\
        
    - name: Upload executÃ¡vel como artefacto
      uses: actions/upload-artifact@v4
      with:
        name: Gerador-Calendario-Windows
        path: dist/Gerador_Calendario_Folgas.exe
        retention-days: 30
        
    - name: Criar Release (apenas para tags)
      if: startsWith(github.ref, 'refs/tags/')
      uses: softprops/action-gh-release@v1
      with:
        files: dist/Gerador_Calendario_Folgas.exe
        body: |
          # Gerador de CalendÃ¡rio 2026 com Folgas
          
          ## Funcionalidades:
          - ðŸ“… CalendÃ¡rio completo de 2026
          - ðŸ”„ Ciclo de folgas personalizÃ¡vel (1-12 semanas)
          - ðŸ‡µðŸ‡¹ Feriados de Portugal incluÃ­dos
          - ðŸŽ¨ Cores para melhor visualizaÃ§Ã£o
          - ðŸ“Š ExportaÃ§Ã£o para Excel
          - ðŸªŸ Interface limpa sem consola
          
          ## Como usar:
          1. Execute o programa (duplo clique)
          2. Escolha a semana de inÃ­cio do ciclo (1-12)
          3. O calendÃ¡rio serÃ¡ gerado automaticamente
          4. O programa fecha automaticamente
          
          **Legenda de cores:**
          - ðŸ”µ Azul: Folgas do ciclo
          - ðŸ”´ Rosa: Feriados
          - ðŸŸ¡ Amarelo: Fins de semana
          - âšª Branco: Dias de trabalho
          
          **Nota:** Esta versÃ£o nÃ£o mostra a consola preta.
